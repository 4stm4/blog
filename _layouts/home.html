---
layout: default
---
{%- assign current_lang = site.lang | default: 'ru' -%}
{%- assign t = site.data.translations[current_lang] -%}
<div class="home">
  {%- if site.categories and site.categories.size > 0 -%}
  <section class="topic-section" aria-label="Категории блога">
    <div class="section-heading">
      <a class="section-link" href="{{ '/categories/' | relative_url }}">{{ t.home.all_categories }}</a>
    </div>
    <div class="topic-grid">
      {%- assign sorted_categories = site.categories | sort -%}
      {%- for category in sorted_categories limit:6 -%}
      {%- assign category_name = category[0] -%}
      {%- assign posts_in_category = category[1] -%}
      {%- assign category_anchor = category_name | slugify -%}
      <a class="topic-chip" href="{{ '/categories/#' | append: category_anchor | relative_url }}">
        <span class="topic-name">{{ category_name | replace: '_', ' ' | capitalize }}</span>
        <span class="topic-count">{{ posts_in_category | size }} {{ t.home.materials_count }}</span>
      </a>
      {%- endfor -%}
    </div>
  </section>
  {%- endif -%}

  {%- if paginator -%}
    {%- assign posts_collection = paginator.posts -%}
  {%- else -%}
    {%- assign posts_collection = site.posts -%}
  {%- endif -%}

  {%- if posts_collection and posts_collection.size > 0 -%}
  <section class="posts-section" aria-labelledby="posts-heading">
    <div class="section-heading">
      <h2 id="posts-heading">{{ t.home.new_materials }}</h2>
      <a class="section-link" href="{{ '/categories/' | relative_url }}">{{ t.home.select_by_interests }}</a>
    </div>
    <div class="post-grid">
      {%- assign date_format = site.minima.date_format | default: "%d.%m.%Y" -%}
      {%- for post in posts_collection limit:6 -%}
      <article class="post-card">
        <a class="post-card-link" href="{{ post.url | relative_url }}">
          <h3 class="post-title">{{ post.title | escape }}</h3>
        </a>
        <p class="post-meta">
          <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: date_format }}</time>
          {%- if post.categories and post.categories.size > 0 -%}
          ·
          <span class="post-categories">
            {%- for category in post.categories -%}
            <span class="post-category">{{ category | replace: '_', ' ' | capitalize }}</span>{% unless forloop.last %}, {% endunless %}
            {%- endfor -%}
          </span>
          {%- endif -%}
        </p>
        <p class="post-excerpt">{{ post.description | default: post.excerpt | strip_html | truncate: 160 }}</p>
        <a class="post-readmore" href="{{ post.url | relative_url }}" aria-label="Читать статью {{ post.title | escape }}">{{ t.home.read_more }}</a>
      </article>
      {%- endfor -%}
    </div>
  </section>
  {%- endif -%}

  <section id="subscribe" class="subscribe-section" aria-labelledby="subscribe-heading">
    <div class="subscribe-inner">
      <div>
        <h2 id="subscribe-heading">{{ t.home.subscribe_heading }}</h2>
        <p>{{ t.home.subscribe_text }}</p>
      </div>
      <div class="subscribe-actions">
        <a class="btn-primary" href="mailto:{{ site.email }}?subject={{ t.home.subscribe_email_subject | url_encode }}">{{ t.home.get_news }}</a>
        <a class="btn-secondary" href="{{ '/feed.xml' | relative_url }}">{{ t.home.get_via_rss }}</a>
      </div>
    </div>
  </section>
</div>
